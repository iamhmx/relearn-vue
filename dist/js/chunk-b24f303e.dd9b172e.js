(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b24f303e"],{"2a95":function(s,t,r){"use strict";(function(s){function r(){return r=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(s[e]=r[e])}return s},r.apply(this,arguments)}function e(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.__proto__=t}function a(s){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},a(s)}function n(s,t){return n=Object.setPrototypeOf||function(s,t){return s.__proto__=t,s},n(s,t)}function l(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(s){return!1}}function p(s,t,r){return p=l()?Reflect.construct:function(s,t,r){var e=[null];e.push.apply(e,t);var a=Function.bind.apply(s,e),l=new a;return r&&n(l,r.prototype),l},p.apply(null,arguments)}function i(s){return-1!==Function.toString.call(s).indexOf("[native code]")}function o(s){var t="function"===typeof Map?new Map:void 0;return o=function(s){if(null===s||!i(s))return s;if("function"!==typeof s)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(s))return t.get(s);t.set(s,r)}function r(){return p(s,arguments,a(this).constructor)}return r.prototype=Object.create(s.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n(r,s)},o(s)}var c=/%[sdj%]/g,v=function(){};function u(s){if(!s||!s.length)return null;var t={};return s.forEach((function(s){var r=s.field;t[r]=t[r]||[],t[r].push(s)})),t}function _(){for(var s=arguments.length,t=new Array(s),r=0;r<s;r++)t[r]=arguments[r];var e=1,a=t[0],n=t.length;if("function"===typeof a)return a.apply(null,t.slice(1));if("string"===typeof a){for(var l=String(a).replace(c,(function(s){if("%%"===s)return"%";if(e>=n)return s;switch(s){case"%s":return String(t[e++]);case"%d":return Number(t[e++]);case"%j":try{return JSON.stringify(t[e++])}catch(r){return"[Circular]"}break;default:return s}})),p=t[e];e<n;p=t[++e])l+=" "+p;return l}return a}function h(s){return"string"===s||"url"===s||"hex"===s||"email"===s||"pattern"===s}function m(s,t){return void 0===s||null===s||(!("array"!==t||!Array.isArray(s)||s.length)||!(!h(t)||"string"!==typeof s||s))}function f(s,t,r){var e=[],a=0,n=s.length;function l(s){e.push.apply(e,s),a++,a===n&&r(e)}s.forEach((function(s){t(s,l)}))}function d(s,t,r){var e=0,a=s.length;function n(l){if(l&&l.length)r(l);else{var p=e;e+=1,p<a?t(s[p],n):r([])}}n([])}function j(s){var t=[];return Object.keys(s).forEach((function(r){t.push.apply(t,s[r])})),t}"undefined"!==typeof s&&Object({NODE_ENV:"production",BASE_URL:"/"});var g=function(s){function t(t,r){var e;return e=s.call(this,"Async Validation Error")||this,e.errors=t,e.fields=r,e}return e(t,s),t}(o(Error));function y(s,t,r,e){if(t.first){var a=new Promise((function(t,a){var n=function(s){return e(s),s.length?a(new g(s,u(s))):t()},l=j(s);d(l,r,n)}));return a["catch"]((function(s){return s})),a}var n=t.firstFields||[];!0===n&&(n=Object.keys(s));var l=Object.keys(s),p=l.length,i=0,o=[],c=new Promise((function(t,a){var c=function(s){if(o.push.apply(o,s),i++,i===p)return e(o),o.length?a(new g(o,u(o))):t()};l.length||(e(o),t()),l.forEach((function(t){var e=s[t];-1!==n.indexOf(t)?d(e,r,c):f(e,r,c)}))}));return c["catch"]((function(s){return s})),c}function b(s){return function(t){return t&&t.message?(t.field=t.field||s.fullField,t):{message:"function"===typeof t?t():t,field:t.field||s.fullField}}}function w(s,t){if(t)for(var e in t)if(t.hasOwnProperty(e)){var a=t[e];"object"===typeof a&&"object"===typeof s[e]?s[e]=r(r({},s[e]),a):s[e]=a}return s}function F(s,t,r,e,a,n){!s.required||r.hasOwnProperty(s.field)&&!m(t,n||s.type)||e.push(_(a.messages.required,s.fullField))}function k(s,t,r,e,a){(/^\s+$/.test(t)||""===t)&&e.push(_(a.messages.whitespace,s.fullField))}var x={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},q={integer:function(s){return q.number(s)&&parseInt(s,10)===s},float:function(s){return q.number(s)&&!q.integer(s)},array:function(s){return Array.isArray(s)},regexp:function(s){if(s instanceof RegExp)return!0;try{return!!new RegExp(s)}catch(t){return!1}},date:function(s){return"function"===typeof s.getTime&&"function"===typeof s.getMonth&&"function"===typeof s.getYear},number:function(s){return!isNaN(s)&&"number"===typeof s},object:function(s){return"object"===typeof s&&!q.array(s)},method:function(s){return"function"===typeof s},email:function(s){return"string"===typeof s&&!!s.match(x.email)&&s.length<255},url:function(s){return"string"===typeof s&&!!s.match(x.url)},hex:function(s){return"string"===typeof s&&!!s.match(x.hex)}};function M(s,t,r,e,a){if(s.required&&void 0===t)F(s,t,r,e,a);else{var n=["integer","float","array","regexp","object","method","email","number","date","url","hex"],l=s.type;n.indexOf(l)>-1?q[l](t)||e.push(_(a.messages.types[l],s.fullField,s.type)):l&&typeof t!==s.type&&e.push(_(a.messages.types[l],s.fullField,s.type))}}function O(s,t,r,e,a){var n="number"===typeof s.len,l="number"===typeof s.min,p="number"===typeof s.max,i=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o=t,c=null,v="number"===typeof t,u="string"===typeof t,h=Array.isArray(t);if(v?c="number":u?c="string":h&&(c="array"),!c)return!1;h&&(o=t.length),u&&(o=t.replace(i,"_").length),n?o!==s.len&&e.push(_(a.messages[c].len,s.fullField,s.len)):l&&!p&&o<s.min?e.push(_(a.messages[c].min,s.fullField,s.min)):p&&!l&&o>s.max?e.push(_(a.messages[c].max,s.fullField,s.max)):l&&p&&(o<s.min||o>s.max)&&e.push(_(a.messages[c].range,s.fullField,s.min,s.max))}var $="enum";function I(s,t,r,e,a){s[$]=Array.isArray(s[$])?s[$]:[],-1===s[$].indexOf(t)&&e.push(_(a.messages[$],s.fullField,s[$].join(", ")))}function A(s,t,r,e,a){if(s.pattern)if(s.pattern instanceof RegExp)s.pattern.lastIndex=0,s.pattern.test(t)||e.push(_(a.messages.pattern.mismatch,s.fullField,t,s.pattern));else if("string"===typeof s.pattern){var n=new RegExp(s.pattern);n.test(t)||e.push(_(a.messages.pattern.mismatch,s.fullField,t,s.pattern))}}var P={required:F,whitespace:k,type:M,range:O,enum:I,pattern:A};function E(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t,"string")&&!s.required)return r();P.required(s,t,e,n,a,"string"),m(t,"string")||(P.type(s,t,e,n,a),P.range(s,t,e,n,a),P.pattern(s,t,e,n,a),!0===s.whitespace&&P.whitespace(s,t,e,n,a))}r(n)}function S(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&P.type(s,t,e,n,a)}r(n)}function N(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(""===t&&(t=void 0),m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&(P.type(s,t,e,n,a),P.range(s,t,e,n,a))}r(n)}function C(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&P.type(s,t,e,n,a)}r(n)}function R(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),m(t)||P.type(s,t,e,n,a)}r(n)}function z(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&(P.type(s,t,e,n,a),P.range(s,t,e,n,a))}r(n)}function D(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&(P.type(s,t,e,n,a),P.range(s,t,e,n,a))}r(n)}function T(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t,"array")&&!s.required)return r();P.required(s,t,e,n,a,"array"),m(t,"array")||(P.type(s,t,e,n,a),P.range(s,t,e,n,a))}r(n)}function V(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&P.type(s,t,e,n,a)}r(n)}var J="enum";function W(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a),void 0!==t&&P[J](s,t,e,n,a)}r(n)}function U(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t,"string")&&!s.required)return r();P.required(s,t,e,n,a),m(t,"string")||P.pattern(s,t,e,n,a)}r(n)}function B(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();var p;if(P.required(s,t,e,n,a),!m(t))p="number"===typeof t?new Date(t):t,P.type(s,p,e,n,a),p&&P.range(s,p.getTime(),e,n,a)}r(n)}function Z(s,t,r,e,a){var n=[],l=Array.isArray(t)?"array":typeof t;P.required(s,t,e,n,a,l),r(n)}function H(s,t,r,e,a){var n=s.type,l=[],p=s.required||!s.required&&e.hasOwnProperty(s.field);if(p){if(m(t,n)&&!s.required)return r();P.required(s,t,e,l,a,n),m(t,n)||P.type(s,t,e,l,a)}r(l)}function L(s,t,r,e,a){var n=[],l=s.required||!s.required&&e.hasOwnProperty(s.field);if(l){if(m(t)&&!s.required)return r();P.required(s,t,e,n,a)}r(n)}var Y={string:E,method:S,number:N,boolean:C,regexp:R,integer:z,float:D,array:T,object:V,enum:W,pattern:U,date:B,url:H,hex:H,email:H,required:Z,any:L};function G(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var s=JSON.parse(JSON.stringify(this));return s.clone=this.clone,s}}}var K=G();function Q(s){this.rules=null,this._messages=K,this.define(s)}Q.prototype={messages:function(s){return s&&(this._messages=w(G(),s)),this._messages},define:function(s){if(!s)throw new Error("Cannot configure a schema with no rules");if("object"!==typeof s||Array.isArray(s))throw new Error("Rules must be an object");var t,r;for(t in this.rules={},s)s.hasOwnProperty(t)&&(r=s[t],this.rules[t]=Array.isArray(r)?r:[r])},validate:function(s,t,e){var a=this;void 0===t&&(t={}),void 0===e&&(e=function(){});var n,l,p=s,i=t,o=e;if("function"===typeof i&&(o=i,i={}),!this.rules||0===Object.keys(this.rules).length)return o&&o(),Promise.resolve();function c(s){var t,r=[],e={};function a(s){var t;Array.isArray(s)?r=(t=r).concat.apply(t,s):r.push(s)}for(t=0;t<s.length;t++)a(s[t]);r.length?e=u(r):(r=null,e=null),o(r,e)}if(i.messages){var v=this.messages();v===K&&(v=G()),w(v,i.messages),i.messages=v}else i.messages=this.messages();var h={},m=i.keys||Object.keys(this.rules);m.forEach((function(t){n=a.rules[t],l=p[t],n.forEach((function(e){var n=e;"function"===typeof n.transform&&(p===s&&(p=r({},p)),l=p[t]=n.transform(l)),n="function"===typeof n?{validator:n}:r({},n),n.validator=a.getValidationMethod(n),n.field=t,n.fullField=n.fullField||t,n.type=a.getType(n),n.validator&&(h[t]=h[t]||[],h[t].push({rule:n,value:l,source:p,field:t}))}))}));var f={};return y(h,i,(function(s,t){var e,a=s.rule,n=("object"===a.type||"array"===a.type)&&("object"===typeof a.fields||"object"===typeof a.defaultField);function l(s,t){return r(r({},t),{},{fullField:a.fullField+"."+s})}function p(e){void 0===e&&(e=[]);var p=e;if(Array.isArray(p)||(p=[p]),!i.suppressWarning&&p.length&&Q.warning("async-validator:",p),p.length&&a.message&&(p=[].concat(a.message)),p=p.map(b(a)),i.first&&p.length)return f[a.field]=1,t(p);if(n){if(a.required&&!s.value)return a.message?p=[].concat(a.message).map(b(a)):i.error&&(p=[i.error(a,_(i.messages.required,a.field))]),t(p);var o={};if(a.defaultField)for(var c in s.value)s.value.hasOwnProperty(c)&&(o[c]=a.defaultField);for(var v in o=r(r({},o),s.rule.fields),o)if(o.hasOwnProperty(v)){var u=Array.isArray(o[v])?o[v]:[o[v]];o[v]=u.map(l.bind(null,v))}var h=new Q(o);h.messages(i.messages),s.rule.options&&(s.rule.options.messages=i.messages,s.rule.options.error=i.error),h.validate(s.value,s.rule.options||i,(function(s){var r=[];p&&p.length&&r.push.apply(r,p),s&&s.length&&r.push.apply(r,s),t(r.length?r:null)}))}else t(p)}n=n&&(a.required||!a.required&&s.value),a.field=s.field,a.asyncValidator?e=a.asyncValidator(a,s.value,p,s.source,i):a.validator&&(e=a.validator(a,s.value,p,s.source,i),!0===e?p():!1===e?p(a.message||a.field+" fails"):e instanceof Array?p(e):e instanceof Error&&p(e.message)),e&&e.then&&e.then((function(){return p()}),(function(s){return p(s)}))}),(function(s){c(s)}))},getType:function(s){if(void 0===s.type&&s.pattern instanceof RegExp&&(s.type="pattern"),"function"!==typeof s.validator&&s.type&&!Y.hasOwnProperty(s.type))throw new Error(_("Unknown rule type %s",s.type));return s.type||"string"},getValidationMethod:function(s){if("function"===typeof s.validator)return s.validator;var t=Object.keys(s),r=t.indexOf("message");return-1!==r&&t.splice(r,1),1===t.length&&"required"===t[0]?Y.required:Y[this.getType(s)]||!1}},Q.register=function(s,t){if("function"!==typeof t)throw new Error("Cannot register a validator by type, validator is not a function");Y[s]=t},Q.warning=v,Q.messages=K,Q.validators=Y,t["a"]=Q}).call(this,r("4362"))},"3ca3":function(s,t,r){"use strict";var e=r("6547").charAt,a=r("69f3"),n=r("7dd0"),l="String Iterator",p=a.set,i=a.getterFor(l);n(String,"String",(function(s){p(this,{type:l,string:String(s),index:0})}),(function(){var s,t=i(this),r=t.string,a=t.index;return a>=r.length?{value:void 0,done:!0}:(s=e(r,a),t.index+=s.length,{value:s,done:!1})}))},4362:function(s,t,r){t.nextTick=function(s){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){s.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(s){throw new Error("No such module. (Possibly not yet loaded)")},function(){var s,e="/";t.cwd=function(){return e},t.chdir=function(t){s||(s=r("df7c")),e=s.resolve(t,e)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"441d":function(s,t,r){"use strict";var e=r("8f0b"),a=r.n(e);a.a},"52c1":function(s,t,r){"use strict";r.r(t);var e=function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("div",[r("div",{staticClass:"form-container"},[r("h3",[s._v("实现效果：")]),r("div",{staticClass:"effect"},[r("MForm",{ref:"form",attrs:{model:s.model,rules:s.rules,"label-position":"right","label-width":"100px"}},[r("MFormItem",{attrs:{label:"用户名：",prop:"username"}},[r("MFormInput",{attrs:{placeholder:"请输入用户名"},model:{value:s.model.username,callback:function(t){s.$set(s.model,"username",t)},expression:"model.username"}})],1),r("MFormItem",{attrs:{label:"密码：",prop:"password"}},[r("MFormInput",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:s.model.password,callback:function(t){s.$set(s.model,"password",t)},expression:"model.password"}})],1),r("MFormItem",[r("button",{on:{click:s.login}},[s._v("登录")])])],1)],1),r("usage"),r("h3",[s._v("组件设计：")]),r("rl-desc",{attrs:{des:s.desData}}),r("im1"),r("point",[s._v("规则校验库async-validator，具体使用参考：https://github.com/yiminghe/async-validator")]),r("im2")],1)])},a=[],n=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},l=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("h3",[s._v("使用方法（类似element-ui的el-form）：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MForm")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("ref")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"form"')]),s._v("\n       "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":model")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"model"')]),s._v("\n       "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":rules")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"rules"')]),s._v("\n       "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("label-position")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"right"')]),s._v("\n       "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("label-width")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"100px"')]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("label")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"用户名："')]),s._v("\n             "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("prop")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"username"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormInput")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-model")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"model.username"')]),s._v("\n                "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("placeholder")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"请输入用户名"')]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormInput")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("label")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"密码："')]),s._v("\n             "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("prop")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"password"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormInput")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"password"')]),s._v("\n                "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-model")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"model.password"')]),s._v("\n                "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("placeholder")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"请输入密码"')]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormInput")]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"login"')]),s._v(">")]),s._v("登录"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MFormItem")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MForm")]),s._v(">")]),s._v("\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  data() {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 数据")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("model")]),s._v(": {\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("username")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(",\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(",\n      },\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 校验规则")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("username")]),s._v(": [{ "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("required")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("message")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请输入用户名'")]),s._v(" }],\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": [{ "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("required")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("message")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请输入密码'")]),s._v(" }],\n      }\n    }\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    login() {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 点击登录，校验数据")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$refs.form.validate("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("valid")]),s._v(" =>")]),s._v(" {\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (valid) {\n          "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$notice.success({\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'提示'")]),s._v(",\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("content")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'成功了'")]),s._v(",\n          })\n        } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n          "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$notice({\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'提示'")]),s._v(",\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'error'")]),s._v(",\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("content")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'校验没通过'")]),s._v(",\n            "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("duration")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3000")]),s._v(",\n          })\n        }\n      })\n    }\n  }\n}\n")])])])}],p=r("2877"),i={},o=Object(p["a"])(i,n,l,!1,null,null,null),c=o.exports,v=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},u=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("h3",[s._v("从内到外实现，先实现form-input组件：")]),r("ol",[r("li",[s._v("MFormInput需要和model数据的值进行双向绑定，需要实现v-model")]),r("li",[s._v("接收类似input标签的属性，比如：type、placeholder")]),r("li",[s._v("当输入的值改变时，需要根据校验规则做校验")])]),r("h3",[s._v("MFormInput.vue：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"form-input-container"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('\x3c!-- $attrs可以获取到没有申明在props中的属性，通过v-bind="$attrs"解构传给input组件 --\x3e')]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input"')]),s._v("\n           "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":value")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"value"')]),s._v("\n           "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-bind")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"$attrs"')]),s._v("\n           "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@input")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onInput"')]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 关闭attrs继承，否则$attrs收集的属性，会挂到根标签上")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("inheritAttrs")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// v-model：接收一个value")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onInput(e) {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// v-model：emit一个input事件")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$emit("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input'")]),s._v(", e.target.value)\n\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 触发规则校验，让父组件自己去派发事件，通知父组件需要进行校验")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$parent.$emit("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'validate'")]),s._v(")\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 注：这里用$parent去获取父组件实例存在问题，因为MFormItemInput并不一定是MFormItem的直接子组件，")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 有可能还包裹了其他组件，类似：")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// <MFormItem>")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//   <Col>")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//     <MFormInput></MFormInput>")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//   </Col>")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// </MFormItem>")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 如果这样$parent，就不是MFormItem了，后面再进行优化")]),s._v("\n    },\n  },\n}\n")])]),r("h3",[s._v("MFormItem.vue：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"form-item-container"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- 存放label和input --\x3e")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"form-item-content"')]),s._v(">")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("label")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":style")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"labelStyle"')]),s._v(">")]),s._v("{{label}}"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("label")]),s._v(">")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("slot")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("slot")]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- 显示校验错误信息 --\x3e")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"form-item-error"')]),s._v("\n          "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":style")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"errorStyle"')]),s._v("\n          "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-show")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(">")]),s._v("{{error}}"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Schema "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'async-validator'")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("label")]),s._v(": {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("default")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    },\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// prop的值是model对象中的key，其的作用，就是从model数据中取具体的值")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("prop")]),s._v(": {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("default")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    }\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 注入MForm提供的MForm组件实例，从而获取model、rules数据")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("inject")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'form'")]),s._v("],\n  data() {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 校验错误信息")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("error")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    }\n  },\n  mounted() {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 监听validate，做校验，MFormInput中触发的校验通知会在这里监听到")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'validate'")]),s._v(", () => {\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".validate()\n    })\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 校验方法实现")]),s._v("\n    validate() {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取对应FormItem校验规则")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" rules = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".form.rules["),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".prop]\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取校验值")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" value = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".form.model["),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".prop]\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 校验描述对象")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" descriptor = { ["),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".prop]: rules }\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建校验器")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" schema = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Schema(descriptor)\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// schema.validate会返回一个Promise，没有触发catch就说明验证通过")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" schema.validate({ ["),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".prop]: value }, errors => {\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (errors) {\n          "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将错误信息显示")]),s._v("\n          "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".error = errors["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("].message\n        } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n          "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 校验通过，重置错误信息")]),s._v("\n          "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".error = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n        }\n      })\n    }\n  }\n}\n")])])])}],_={},h=Object(p["a"])(_,v,u,!1,null,null,null),m=h.exports,f=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},d=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("h3",[s._v("MForm需要实现全局校验方法，对所有MFormItem进行校验，所以MForm要拿到所有MFormItem实例，并调用它们自己的validate方法，在MFormItem实例挂载后，通知MForm，并把自己实例传给MForm：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// FormItem.vue")]),s._v("\nmounted() {\n  ...\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 告诉MForm，我已经挂载了，把我自己也交给你。注：这里需要优化")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$parent.$emit("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'add-item'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(")\n}\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Form.vue")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  provide() {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 提供MForm，方便MFormItem获取model、rules")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("form")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v("\n    }\n  },\n  created() {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 保存所有MFormItem实例")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".fields = []\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 监听add-item方法，保存MFormItem实例")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'add-item'")]),s._v(", item => {\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".fields.push(item)\n    })\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 全局校验方法，会这样使用：this.$refs.form.validate(valid => {})")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 实现validate方法：")]),s._v("\n    validate(cb) {\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 过滤掉没有prop的MFormItem，然后执行它们的validate方法，validate方法返回Promise对象")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" tasks = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".fields\n          .filter("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("field")]),s._v(" =>")]),s._v(" field.prop)\n          .map("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item.validate())\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 所有校验通过，回调true，否则回调false")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all(tasks)\n        .then("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" cb("),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("))\n        .catch("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" cb("),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("))\n    }\n  }\n}\n")])]),r("h3",[s._v("优化$parent会出现的问题")]),r("p",[s._v("当父子结构被破坏时，$parent就获取不到想要的父组件，有两个地方用到了$parent：")]),r("ul",[r("li",[s._v("MFormInput触发规则校验")]),r("li",[s._v("MFormItem通知MForm已经挂载了")])]),r("p",[s._v("参考element-ui的实现，采用mixin的方式，混入一个dispatch方法，指定要处理事件的组件，让它处理：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n        "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// componentName：组件名；eventName：方法名；payload：参数")]),s._v("\n        dispatch(componentName, eventName, payload) {\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" parent = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$parent || "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$root\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" name = parent.$options.componentName\n            "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 向上查找父级组件，直到找到指定组件")]),s._v("\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("while")]),s._v(" (parent && (!name || name !== componentName)) {\n                parent = parent.$parent\n                "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (parent) {\n                    name = parent.$options.componentName\n                }\n            }\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (parent) {\n                "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 找到了，执行方法")]),s._v("\n                parent.$emit.call(parent, eventName, payload)\n            }\n        }\n    }\n}\n")])]),r("p",[s._v("修改如下：")]),r("ul",[r("li",[s._v("给MFormItem.vue添加 componentName: 'form-item'")]),r("li",[s._v("给MForm.vue添加 componentName: 'form'")]),r("li",[s._v("给MFormItem、MFormInput混入方法")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" emitter "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@/mixins/emitter'")]),s._v("\n...\nmixins: [emitter]\n")])]),r("p",[s._v("修改MFormInput：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// this.$parent.$emit('validate')")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用mixins混入的dispatch方法，向上找到form-item")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".dispatch("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'form-item'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'validate'")]),s._v(")\n")])]),r("p",[s._v("修改MForm：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// this.$parent.$emit('add-item', this)")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".dispatch("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'form'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'add-item'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(")\n")])])])}],j={},g=Object(p["a"])(j,f,d,!1,null,null,null),y=g.exports,b=function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("div",{staticClass:"form-input-container"},[r("input",s._b({staticClass:"input",domProps:{value:s.value},on:{input:s.onInput}},"input",s.$attrs,!1))])},w=[],F={methods:{dispatch:function(s,t,r){var e=this.$parent||this.$root,a=e.$options.componentName;while(e&&(!a||a!==s))e=e.$parent,e&&(a=e.$options.componentName);e&&e.$emit.call(e,t,r)}}},k={inheritAttrs:!1,mixins:[F],props:{value:String},methods:{onInput:function(s){this.$emit("input",s.target.value),this.dispatch("form-item","validate")}}},x=k,q=(r("68fb"),Object(p["a"])(x,b,w,!1,null,"359ed4e7",null)),M=q.exports,O=function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("div",{staticClass:"form-item-container"},[r("div",{staticClass:"form-item-content"},[r("label",{style:s.labelStyle},[s._v(s._s(s.label))]),s._t("default")],2),r("span",{directives:[{name:"show",rawName:"v-show",value:s.error,expression:"error"}],staticClass:"form-item-error",style:s.errorStyle},[s._v(s._s(s.error))])])},$=[];function I(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}var A=r("2a95"),P={componentName:"form-item",mixins:[F],props:{label:{type:String,default:""},prop:{type:String,default:""}},inject:["form"],data:function(){return{error:""}},computed:{labelStyle:function(){return{fontSize:"14px",width:this.form.labelWidth,textAlign:this.form.labelPosition}},errorStyle:function(){return{fontSize:"12px",position:"absolute",left:this.form.labelWidth,top:"40px",height:"15px",lineHeight:"15px"}}},mounted:function(){var s=this;this.$on("validate",(function(){s.validate()})),this.dispatch("form","add-item",this)},methods:{validate:function(){var s=this,t=this.form.rules[this.prop],r=this.form.model[this.prop],e=I({},this.prop,t),a=new A["a"](e);return a.validate(I({},this.prop,r),(function(t){s.error=t?t[0].message:""}))}}},E=P,S=(r("441d"),Object(p["a"])(E,O,$,!1,null,"d7e6b054",null)),N=S.exports,C=function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("div",[s._t("default")],2)},R=[],z=(r("4de4"),r("caad"),r("d81d"),r("d3b7"),r("3ca3"),r("ddb0"),{componentName:"form",props:{model:{type:Object,required:!0},rules:{type:Object,default:function(){}},labelWidth:String,labelPosition:{type:String,default:"left",validator:function(s){return["left","center","right"].includes(s)}}},provide:function(){return{form:this}},created:function(){var s=this;this.fields=[],this.$on("add-item",(function(t){s.fields.push(t)}))},methods:{validate:function(s){var t=this.fields.filter((function(s){return s.prop})).map((function(s){return s.validate()}));Promise.all(t).then((function(){return s(!0)})).catch((function(){return s(!1)}))}}}),D=z,T=Object(p["a"])(D,C,R,!1,null,"5d7f40f4",null),V=T.exports,J={components:{usage:c,im1:m,im2:y,MForm:V,MFormInput:M,MFormItem:N},data:function(){return{desData:[{title:"MForm组件：",content:"统一管理model、rules，统一校验"},{title:"MFormItem组件：",content:"处理label、error，实现MFormInput的数据校验方法"},{title:"MFormInput组件：",content:"实现v-model，和model数据做双向绑定，触发验证"}],model:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名"}],password:[{required:!0,message:"请输入密码"}]}}},methods:{login:function(){var s=this;this.$refs.form.validate((function(t){t?s.$notice.success({title:"提示",content:"成功了"}):s.$notice({title:"提示",type:"error",content:"校验没通过",duration:3e3})}))}}},W=J,U=(r("a18b"),Object(p["a"])(W,e,a,!1,null,"11ea411e",null));t["default"]=U.exports},6547:function(s,t,r){var e=r("a691"),a=r("1d80"),n=function(s){return function(t,r){var n,l,p=String(a(t)),i=e(r),o=p.length;return i<0||i>=o?s?"":void 0:(n=p.charCodeAt(i),n<55296||n>56319||i+1===o||(l=p.charCodeAt(i+1))<56320||l>57343?s?p.charAt(i):n:s?p.slice(i,i+2):l-56320+(n-55296<<10)+65536)}};s.exports={codeAt:n(!1),charAt:n(!0)}},"68fb":function(s,t,r){"use strict";var e=r("d8e5"),a=r.n(e);a.a},"8f0b":function(s,t,r){},a18b:function(s,t,r){"use strict";var e=r("afe3"),a=r.n(e);a.a},afe3:function(s,t,r){},d8e5:function(s,t,r){},df7c:function(s,t,r){(function(s){function r(s,t){for(var r=0,e=s.length-1;e>=0;e--){var a=s[e];"."===a?s.splice(e,1):".."===a?(s.splice(e,1),r++):r&&(s.splice(e,1),r--)}if(t)for(;r--;r)s.unshift("..");return s}function e(s){"string"!==typeof s&&(s+="");var t,r=0,e=-1,a=!0;for(t=s.length-1;t>=0;--t)if(47===s.charCodeAt(t)){if(!a){r=t+1;break}}else-1===e&&(a=!1,e=t+1);return-1===e?"":s.slice(r,e)}function a(s,t){if(s.filter)return s.filter(t);for(var r=[],e=0;e<s.length;e++)t(s[e],e,s)&&r.push(s[e]);return r}t.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var l=n>=0?arguments[n]:s.cwd();if("string"!==typeof l)throw new TypeError("Arguments to path.resolve must be strings");l&&(t=l+"/"+t,e="/"===l.charAt(0))}return t=r(a(t.split("/"),(function(s){return!!s})),!e).join("/"),(e?"/":"")+t||"."},t.normalize=function(s){var e=t.isAbsolute(s),l="/"===n(s,-1);return s=r(a(s.split("/"),(function(s){return!!s})),!e).join("/"),s||e||(s="."),s&&l&&(s+="/"),(e?"/":"")+s},t.isAbsolute=function(s){return"/"===s.charAt(0)},t.join=function(){var s=Array.prototype.slice.call(arguments,0);return t.normalize(a(s,(function(s,t){if("string"!==typeof s)throw new TypeError("Arguments to path.join must be strings");return s})).join("/"))},t.relative=function(s,r){function e(s){for(var t=0;t<s.length;t++)if(""!==s[t])break;for(var r=s.length-1;r>=0;r--)if(""!==s[r])break;return t>r?[]:s.slice(t,r-t+1)}s=t.resolve(s).substr(1),r=t.resolve(r).substr(1);for(var a=e(s.split("/")),n=e(r.split("/")),l=Math.min(a.length,n.length),p=l,i=0;i<l;i++)if(a[i]!==n[i]){p=i;break}var o=[];for(i=p;i<a.length;i++)o.push("..");return o=o.concat(n.slice(p)),o.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(s){if("string"!==typeof s&&(s+=""),0===s.length)return".";for(var t=s.charCodeAt(0),r=47===t,e=-1,a=!0,n=s.length-1;n>=1;--n)if(t=s.charCodeAt(n),47===t){if(!a){e=n;break}}else a=!1;return-1===e?r?"/":".":r&&1===e?"/":s.slice(0,e)},t.basename=function(s,t){var r=e(s);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(s){"string"!==typeof s&&(s+="");for(var t=-1,r=0,e=-1,a=!0,n=0,l=s.length-1;l>=0;--l){var p=s.charCodeAt(l);if(47!==p)-1===e&&(a=!1,e=l+1),46===p?-1===t?t=l:1!==n&&(n=1):-1!==t&&(n=-1);else if(!a){r=l+1;break}}return-1===t||-1===e||0===n||1===n&&t===e-1&&t===r+1?"":s.slice(t,e)};var n="b"==="ab".substr(-1)?function(s,t,r){return s.substr(t,r)}:function(s,t,r){return t<0&&(t=s.length+t),s.substr(t,r)}}).call(this,r("4362"))}}]);
//# sourceMappingURL=chunk-b24f303e.dd9b172e.js.map