(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c85cb"],{"550e":function(s,r,t){"use strict";t.r(r);var a=function(){var s=this,r=s.$createElement,t=s._self._c||r;return t("div",[t("md")],1)},n=[],e=function(){var s=this,r=s.$createElement;s._self._c;return s._m(0)},l=[function(){var s=this,r=s.$createElement,t=s._self._c||r;return t("section",[t("h3",[s._v("数组响应式")]),t("p",[s._v("数组响应式，即：实现在操作数组的同时能够通知更新，"),t("code",{pre:!0},[s._v("vue2.0")]),s._v(" 采用原型覆盖的方式来处理数组的响应式")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取数组原型")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arrayProto = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Array")]),s._v(".prototype\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 复制一份，避免污染")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arrayMethods = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Object")]),s._v(".create(arrayProto)\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 7个修改数组的方法，需要覆盖的方法")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" methodsToPatch = [\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'push'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'pop'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'shift'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'unshift'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'splice'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sort'")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'reverse'")]),s._v("\n]\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 遍历拦截修改数组的方法")]),s._v("\nmethodsToPatch.forEach("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("method")]),s._v(") ")]),s._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 缓存原始方法")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" original = arrayProto[method]\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用数组方法，实际会执行mutator")]),s._v("\n  def(arrayMethods, method, "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("mutator")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 执行原始方法，用于最终结果返回")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = original.apply("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(", args)\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取observer")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" ob = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".__ob__\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 有新元素插入的3个操作")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" inserted\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("switch")]),s._v(" (method) {\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'push'")]),s._v(":\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'unshift'")]),s._v(":\n        inserted = args\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'splice'")]),s._v(":\n        inserted = args.slice("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n    }\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新加入元素有可能也是对象，需要执行响应式处理")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (inserted) ob.observeArray(inserted)\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 通知更新")]),s._v("\n    ob.dep.notify()\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 返回数组操作的结果")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result\n  })\n})\n")])])])}],p=t("2877"),_={},v=Object(p["a"])(_,e,l,!1,null,null,null),c=v.exports,o={components:{md:c}},h=o,j=Object(p["a"])(h,a,n,!1,null,"38fc8670",null);r["default"]=j.exports}}]);
//# sourceMappingURL=chunk-2d0c85cb.e3cbdbfd.js.map